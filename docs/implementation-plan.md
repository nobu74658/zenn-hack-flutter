# 英単語学習Flutter アプリ実装計画（暗記専用版）

## 📱 プロジェクト概要

**アプリ名**: GenFlash English Study（暗記専用版）  
**コンセプト**: Tinder/Tappleライクなスワイプインターフェースを使用した英単語暗記アプリ  
**目的**: 事前に生成された画像付きフラッシュカードで効率的な暗記学習を提供

**🎯 暗記専用アプリの特徴:**
- **表示特化**: フラッシュカードの表示と暗記学習のみ
- **読み取り専用**: データの作成・編集・削除は行わない
- **高速動作**: 軽量化されたデータ構造で快適な学習体験
- **オフライン対応**: ローカルキャッシュによる安定した学習環境

## 🎯 主要機能（暗記専用）

### 1. 認証機能（簡素化）
- ユーザーID による簡易認証
- ローカルセッション管理
- ~~バックエンドAPI認証連携~~ → **削除済み**

### 2. スワイプ学習機能（メイン機能）
- スタック形式のカード表示
- スワイプによる「覚えた/覚えていない」表示切替
- スムーズなカードアニメーション
- ~~学習進捗リアルタイム更新~~ → **表示のみ**

### 3. フラッシュカード表示（読み取り専用）
- カード一覧表示（グリッド・リスト）
- カード詳細表示
- ~~メモ機能~~ → **表示のみ**
- ~~学習状態管理（checkFlag）~~ → **表示のみ**

## 🏗️ アーキテクチャ設計

### Clean Architecture + MVVM パターン

```
lib/
├── domain/                     # ビジネスロジック層
│   └── models/                 # Freezedエンティティ
│       ├── user/               # ユーザー関連モデル
│       ├── flashcard/          # フラッシュカード関連モデル
│       ├── meaning/            # 意味・定義関連モデル
│       └── common/             # 共通モデル・列挙型
├── data/                       # データアクセス層
│   ├── repositories/           # Repository実装
│   │   ├── user/               # ユーザーデータ操作
│   │   ├── flashcard/          # フラッシュカード操作
│   │   └── meaning/            # 意味データ操作
│   └── services/               # API通信
│       ├── http_client.dart    # HTTP基盤
│       ├── user_api_service.dart
│       ├── flashcard_api_service.dart
│       └── meaning_api_service.dart
├── core/                       # 共通基盤
│   ├── constants/              # 定数・設定
│   ├── exceptions/             # 例外定義
│   ├── utils/                  # ユーティリティ
│   └── services/               # コアサービス
└── ui/                         # プレゼンテーション層
    ├── auth/                   # 認証画面
    ├── home/                   # ホーム画面
    ├── study/                  # スワイプ学習画面
    ├── card_list/              # カード一覧画面
    ├── shared/                 # 共通UI
    ├── notifiers/              # StateNotifier (MVVM)
    └── widgets/                # UI Components
```

### 主要技術スタック（暗記専用最適化）

| 技術領域 | 使用技術 | 目的 |
|---------|---------|------|
| **状態管理** | Riverpod | DI・グローバル状態管理 |
| **HTTP通信** | Dio | **読み取り専用**RESTful API通信 |
| **データモデル** | Freezed + JSON | イミュータブルモデル・シリアライゼーション |
| **UI** | Flutter Material 3 | モダンなデザインシステム |
| **ローカルストレージ** | SharedPreferences | **キャッシュデータ永続化** |
| **認証** | 独自実装 | **簡易認証**（読み取り専用アクセス） |

## 📊 データ構造

### 主要エンティティ

#### User Model（シンプル化）
```dart
@freezed
class User with _$User {
  const factory User({
    required String userId,
    required String email,
    required String userName,
    // flashcardIdList → 削除済み（暗記アプリでは不要）
  }) = _User;
}
```

#### Flashcard Model（オブジェクト参照構造）
```dart
@freezed
class Flashcard with _$Flashcard {
  const factory Flashcard({
    required String flashcardId,
    required Word word,           // ← オブジェクト参照
    required List<Meaning> meanings, // ← 展開済み配列
    required Media media,         // ← オブジェクト参照
    required int version,
    required String memo,         // ← 表示専用
    required bool checkFlag,      // ← 表示専用
    // その他の更新系フィールドは削除済み
  }) = _Flashcard;
}
```

#### Word Model（新規追加）
```dart
@freezed
class Word with _$Word {
  const factory Word({
    required String wordId,
    required String word,
    required String coreMeaning,
    required String explanation,
  }) = _Word;
}
```

#### Meaning Model（型安全性向上）
```dart
@freezed
class Meaning with _$Meaning {
  const factory Meaning({
    required String meaningId,
    required PartOfSpeech pos,    // ← Enum型
    required String translation,
    required String pronunciation,
    required String exampleEng,
    required String exampleJpn,
  }) = _Meaning;
}
```

#### Media Model（最小限構成）
```dart
@freezed
class Media with _$Media {
  const factory Media({
    required String mediaId,
    required String meaningId,
    required List<String> mediaUrls,
  }) = _Media;
}
```

## 🛠️ 実装ロードマップ（読み取り専用暗記アプリ版）

### ✅ Phase 1: 基盤構築（完了）
- [x] プロジェクト構造セットアップ
- [x] 依存関係追加・設定
- [x] **暗記専用データモデル作成**（シンプル化完了）
- [x] **読み取り専用API Service層実装**
- [x] **読み取り専用Repository Pattern実装**
- [x] 簡易認証基盤実装

---

## 📋 最適化実装順序（Phase 2-5）

### **Phase 2: アプリ基盤構築** (1週間) 🏗️
**目標**: 動作する基本アプリケーション

- [ ] **Step 1**: `main.dart` + Riverpod ProviderScope設定
- [ ] **Step 2**: `AppTheme` + `AppColors` - Webテーマ統合
- [ ] **Step 3**: Router設定（go_router）- 基本ナビゲーション
- [ ] **Step 4**: ホーム画面実装 - シンプルなメニュー画面

**成果物**: 起動して画面遷移できるベースアプリ

---

### **Phase 3: 最重要機能実装** (2週間) ⭐
**目標**: アプリの核心価値（Tinder風スワイプ学習）

#### **Week 1: スワイプカードシステム**
- [ ] **Step 5**: **Issue #11 - Tinder風スワイプカード実装** (最優先)
  - [ ] カードスタック表示コンポーネント
  - [ ] 高度なスワイプジェスチャー検出
  - [ ] スムーズなアニメーション（60fps）
  - [ ] 視覚・ハプティックフィードバック

#### **Week 2: 学習画面統合**
- [ ] **Step 6**: **Issue #5 - スワイプ学習画面実装**
  - [ ] フラッシュカードデータ表示
  - [ ] 学習フロー（カード進行）
  - [ ] 進捗表示（読み取り専用）
  - [ ] スワイプカードとの統合

**成果物**: 完全に動作するスワイプ学習体験

---

### **Phase 4: サポート機能実装** (1週間) 📱
**目標**: 学習をサポートする補助機能

- [ ] **Step 7**: **Issue #6 - カード一覧画面実装**
  - [ ] グリッド・リスト表示切替
  - [ ] 検索・フィルタ機能
  - [ ] 学習状態表示（読み取り専用）

- [ ] **Step 8**: **Issue #7 - カード詳細画面実装**
  - [ ] 読み取り専用詳細表示
  - [ ] モバイル最適化レイアウト
  - [ ] Webテーマ統合

**成果物**: 完全な学習管理機能

---

### **Phase 5: 最適化・拡張** (1週間) 🚀
**目標**: 高品質なユーザー体験

- [ ] **Step 9**: **Issue #12 - モバイルUI最適化**
  - [ ] レスポンシブ対応（全画面サイズ）
  - [ ] アクセシビリティ強化
  - [ ] プラットフォーム固有デザイン

- [ ] **Step 10**: **Issue #13 - オフライン対応強化**
  - [ ] 多層キャッシュシステム
  - [ ] 完全オフライン学習機能

- [ ] **Step 11**: **Issue #8 - 学習統計画面実装**
  - [ ] 読み取り専用統計ダッシュボード
  - [ ] チャート・グラフ表示
  - [ ] 学習データ可視化

**成果物**: プロダクションレディなアプリ

---

### **Phase 6: 品質向上・最終調整** (1週間) 🧪
**目標**: 市場投入可能な品質

- [ ] **Step 12**: **Issue #9 - パフォーマンス最適化**
  - [ ] 60fps アニメーション維持
  - [ ] メモリ効率最適化
  - [ ] バッテリー消費最小化

- [ ] **Step 13**: **テスト・品質保証**
  - [ ] ユニットテスト
  - [ ] ウィジェットテスト
  - [ ] 統合テスト
  - [ ] エラーハンドリング強化

**成果物**: 市場投入準備完了

---

## 🎯 実装順序の根拠

### **なぜこの順序なのか？**

1. **価値優先**: スワイプカード（差別化要因）を最優先
2. **段階的価値提供**: 各Phase完了時点で価値あるアプリ
3. **依存関係考慮**: 基盤→コア→サポート→最適化
4. **早期フィードバック**: 重要機能を先に実装してユーザーテスト

### **各Phaseの重要度**

| Phase | 重要度 | ビジネス価値 | 技術難易度 | 期間 |
|-------|--------|--------------|------------|------|
| Phase 2 | 🔴 HIGH | 基盤必須 | ⭐⭐ | 1週間 |
| Phase 3 | 🔴 HIGH | 🎯 最大価値 | ⭐⭐⭐⭐ | 2週間 |
| Phase 4 | 🟡 MEDIUM | サポート価値 | ⭐⭐⭐ | 1週間 |
| Phase 5 | 🟡 MEDIUM | UX向上 | ⭐⭐⭐ | 1週間 |
| Phase 6 | 🟢 LOW | 品質保証 | ⭐⭐ | 1週間 |

### **💡 実装のコツ**

1. **Phase 3（スワイプカード）** に最も時間をかける
2. **早期プロトタイプ** でユーザーフィードバック取得
3. **並行開発可能** な部分は同時進行
4. **各Phase完了時** に動作確認・デモ実施

---

## 🚀 次のアクション

### **今すぐ始めるべき実装**
1. **main.dart のRiverpod設定** - アプリの根幹
2. **AppTheme/AppColorsの適用** - 見た目の統一
3. **Issue #11 スワイプカード** - 最重要機能

## 🔗 バックエンドAPI連携

### 主要エンドポイント

| エンドポイント | メソッド | 用途 | 変更 |
|--------------|---------|------|------|
| `/user/{userId}` | GET | ユーザー情報取得 | ✅ 保持 |
| `/flashcard/{userId}` | GET | フラッシュカード一覧 | ✅ 保持 |
| `/meaning/{wordId}` | GET | 単語の意味取得 | ✅ 保持 |
| ~~`/user/setup`~~ | ~~POST~~ | ~~ユーザー登録~~ | ❌ **削除済み** |
| ~~`/flashcard/update/checkFlag`~~ | ~~PUT~~ | ~~学習状態更新~~ | ❌ **削除済み** |

### API通信フロー（読み取り専用）
1. **認証**: ユーザーIDによる簡易セッション管理
2. **データ取得**: フラッシュカード・意味情報の取得
3. ~~**状態更新**: 学習進捗・メモの更新~~ → **削除済み**
4. **キャッシュ戦略**: **オフライン対応の読み取り専用データ永続化**

## 🎨 UI/UX設計方針（暗記専用最適化）

### デザインシステム
- **Material 3 Design System**採用
- **一貫性のあるカラーパレット**
- **直感的なナビゲーション**
- **アクセシビリティ対応**

### ユーザーエクスペリエンス（暗記特化）
- **スワイプジェスチャー**による高速暗記学習体験
- **プログレッシブ開示**による情報階層の整理
- **視覚的フィードバック**による学習状況の把握
- **ダークモード対応**
- **オフライン優先**設計による安定した学習環境

### キーアニメーション
- カードスワイプアニメーション
- ページ遷移アニメーション
- 学習進捗表示アニメーション
- ローディング・フィードバック

## 📈 パフォーマンス戦略

### 最適化ポイント
1. **効率的な状態管理**: Riverpodによる最小限の再描画
2. **画像最適化**: キャッシュ・遅延読み込み
3. **データ同期**: 増分同期・バックグラウンド処理
4. **メモリ管理**: 適切なリソース管理

### スケーラビリティ
- **モジュラー設計**: 機能別の独立性
- **プラガブルアーキテクチャ**: 新機能の容易な追加
- **テスタビリティ**: 高いテストカバレッジ

## 🎯 成功指標（KPI）

### 技術指標
- **テストカバレッジ**: 80%以上
- **ビルド時間**: 3分以内
- **アプリサイズ**: 50MB以下
- **起動時間**: 3秒以内

### ユーザー体験指標
- **学習継続率**: 週次75%以上
- **操作レスポンス**: 100ms以内
- **クラッシュ率**: 0.1%以下
- **評価**: App Store 4.5⭐以上

## 📅 マイルストーン

| 週 | 目標 | 主要deliverable |
|----|------|----------------|
| Week 1 | 基盤構築完了 | ✅ Models, Services, Repositories |
| Week 2 | 認証・基本UI | 🔄 Login, Navigation, Commons |
| Week 3 | スワイプ学習機能 | 🎯 Main swipe interface |
| Week 4 | カード管理機能 | 📋 List, Detail, Edit |
| Week 5 | 統合・テスト | 🧪 Testing, Polish, Deploy |

## 🚀 次のアクション

### **Step-by-Step 実装ガイド**

#### **📋 Phase 2-3 詳細タスク（最優先）**

**Phase 2 - アプリ基盤 (1週間):**
1. **main.dart**: ProviderScope + Material App設定
2. **AppTheme**: Webカラー統合 + Material 3
3. **Router**: go_router基本設定
4. **HomeScreen**: メニュー画面

**Phase 3 - スワイプカード (2週間):**
5. **SwipeCardWidget**: Tinder風カードコンポーネント
6. **GestureDetector**: 高度なスワイプ検出
7. **Animation**: 60fps アニメーション
8. **SwipeStudyScreen**: 学習画面統合

### **🎯 開発優先順位**
1. **🔴 最優先**: Phase 2-3（アプリ基盤+スワイプカード）
2. **🟡 優先**: Phase 4（一覧・詳細画面）
3. **🟢 後回し**: Phase 5-6（最適化・テスト）

### **⚡ 実装時の注意点**
- **Phase 3**に最も時間をかける（技術難易度最高）
- 各Phase完了時に動作確認・デモ実施
- スワイプカードの完成度がアプリの成功を左右する

### 削除された機能
- ❌ フラッシュカード作成・編集・削除機能
- ❌ メディア生成・比較機能
- ❌ プロンプトテンプレート管理
- ❌ 学習データの更新・同期機能

---

## 🎯 暗記専用アプリ化による効果

### ✅ 実現される利点
- **高速動作**: 更新処理がないため軽量で高速
- **安定性**: データ変更がないため一貫した動作
- **オフライン対応**: ローカルキャッシュによる完全なオフライン学習
- **シンプルさ**: 直感的でわかりやすいユーザーインターフェース

### 🎯 学習効率の向上
- **集中力**: 余計な機能がなく学習に集中できる
- **高速反復**: スワイプによる高速暗記学習体験
- **継続性**: シンプルな操作で継続しやすい学習環境

**この暗記専用実装計画により、効率的で高品質な英単語暗記アプリを構築し、ユーザーの学習成果を最大化します。**